<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css"
              integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU"
              crossorigin="anonymous">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Franklin:300,400" >
        <link rel="stylesheet" type="text/css" href="/css/locusBrowser.css">


    </head>
    <body class="container-fluid" style="margin-top:20px; margin-left: 20px;">
    <h3>GTEx Locus Browser</h3>
    <hr>
    <div class="row">
        <div class="btn-group btn-group-sm col-lg-2 col-md-2 col-sm-3">
            <a id="show-v-id" class="btn btn-outline-info">Show Variant ID</a>
            <a id="change-qtl-map" class="btn btn-outline-info">Use Bubble Map</a>
            <a id="zoom-reset" class="btn btn-outline-info">reset</a>
        </div>
        <div class="btn-group btn-group-sm col-lg-1 col-md-2 col-sm-3">
            <span style="margin-right: 10px;">Zoom</span>
            <a id="zoom-minus" class="btn btn-outline-info"><i class="fa fa-search-minus"></i></a>
            <a id="zoom-plus" class="btn btn-outline-info"><i class="fa fa-search-plus"></i></a>
        </div>
    <div class="col-lg-3">
        <span id="zoom-size"></span>
    </div>
    </div>

    <div id="locus-browser"><!-- Root DOM for the SVG --></div>
    <div id="ld-browser"><!-- Root DOM for the LD map--></div>
    </body>
    <script src="/build/js/locus-browser.bundle.min.js"></script>
    <script>
        const GlobalWidth = window.innerWidth;
        const host = "https://dev.gtexportal.org/rest/v1/";


        const panels = {
                geneMap: {
                    id: 'gene-map',
                    data: null,
                    useLog: true,
                    logBase: null,
                    margin: {
                        top: 50, // provide enough space for the color legend
                        right: 100, // provide enough space for the row labels
                        bottom: 100, // provide enough space for the column labels
                        left: 80
                    },
                    width: GlobalWidth,
                    height: 160, // outer height: this includes top and bottom margins + inner height
                    colorScheme: "Blues",
                    cornerRadius: 2,
                    columnLabel: {
                        angle: 90,
                        adjust: 10
                    },
                    rowLabel: {
                        width: 100
                    }
                },
                tssTrack: {
                    id: 'tss-track',
                    label: 'TSS location',
                    data: null,
                    yPos: null, // where the panel should be placed to be calculated based on the panel layout
                    margin: {
                        top: 50,
                        right: 50,
                        bottom: 0,
                        left: 80
                    },
                    width: GlobalWidth,
                    height: 70, // outer height=inner height + top margin + bottom margin
                    color: {
                        background: "#ffffff",
                        feature: "#ababab"
                    }
                },
                geneModelTrack: {
                    id: 'gene-model-track',
                    label: "Gene model",
                    yPos: null,
                    margin: {
                        top: 0,
                        right: 50,
                        bottom: 10,
                        left: 80
                    },
                    width: GlobalWidth,
                    height: 30,
                    color: {
                        background: '#ffffff',
                        feature: "#910807"
                    }
                },
                eqtlTrack: {
                    id: 'eqtl-track',
                    label: 'eQTL summary',
                    data: null,
                    yPos: null,
                    margin: {
                        top: 0,
                        right: 50,
                        bottom: 0,
                        left: 80
                    },
                    width: GlobalWidth,
                    height: 20, // outer height. outer height=inner height + top margin + bottom margin.
                    color: {
                        background: "#ffffff",
                        feature: "#ababab"
                    }

                },
                sqtlTrack: {
                    id: 'sqtl-track',
                    label: 'sQTL summary',
                    data: null,
                    yPos: null,
                    margin: {
                        top: 0,
                        right: 50,
                        bottom: 0,
                        left: 80
                    },
                    width: GlobalWidth,
                    height: 20, // outer height. outer height=inner height + top margin + bottom margin.
                    color: {
                        background: "#ffffff",
                        feature: "#ababab"
                    }
                },

                qtlMap: {
                    id: 'qtl-map', // the bubble heat map of QTLs
                    mapType: "barmap",
                    width: GlobalWidth,
                    data: null,
                    yPos: null,
                    margin: {
                        top: 70, // at least 70, provide space for the genome position scale and brush lines
                        right: 100, // at least 50 for axis
                        bottom: 20, // at least 20
                        left: 200, // at least 200 for text labels
                    },
                    height: 700,
                    colorScheme: "RdBu", // TODO: review these plot options
                    colorScaleDomain: [-1, 1],
                    useLog: false,
                    logBase: null,
                    showRowLabel: false,
                    label: {
                        column: {
                            show: true,
                            angle: 90,
                            adjust: 10,
                            location: 'bottom',
                            textAlign: 'left'
                        },
                        row: {
                            show: true,
                            width: 150,
                            angle: 0,
                            adjust: 0,
                            location: 'left',
                            textAlign: 'right'
                        }
                    }
                }
            };
        let config = {
            id: "locus-browser",
            ldId: "ld-browser",
            width: GlobalWidth,
            height: null, // should be dynamically calculated
            genomicWindow: 1e6,
            urls: LocusBrowser.dataUrls,
            parsers: LocusBrowser.dataParsers,
            dataFilters: LocusBrowser.dataFilters,
            data: LocusBrowser.data,
            dataSort: LocusBrowser.dataSort,
            panels: panels,
            ld: { // LD configuration is separate from the panels because it's in its own DIV and is rendered using canvas.
                id: "ld-browser",
                data: [],
                cutoff: 0.1,
                width: GlobalWidth,
                margin: {
                    top: 10,
                    right: 100,
                    bottom: 0,
                    left: 200
                },
                colorScheme: "Greys"
            }
        };
        document.addEventListener('DOMContentLoaded', function() {
            LocusBrowser.render("ACTN3", config);
            LocusBrowser.setUIEvents("ACTN3", config);

        });

    </script>

</html>